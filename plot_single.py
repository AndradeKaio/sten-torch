#this plots results from test.py
import matplotlib.pyplot as plt

sparsity = [0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 0.95, 0.99]

cuda_comp = [
    0.024743294715881346,
    0.021730947494506835,
    0.020061898231506347,
    0.01784636974334717,
    0.015367889404296875,
    0.013157892227172851,
    0.010668540000915527,
    0.008110833168029786,
    0.005536890029907227,
    0.0028962612152099608,
    0.001546025276184082,
    0.0003912687301635742
]

cuda_nocomp = [
    0.024296903610229494,
    0.021761393547058104,
    0.020299386978149415,
    0.017897891998291015,
    0.015485262870788575,
    0.013194441795349121,
    0.010741758346557616,
    0.008173274993896484,
    0.005569577217102051,
    0.0029151201248168944,
    0.0015537738800048828,
    0.0003886222839355469,
]

cpu_comp = [
    0.07776288986206055,
    0.05047516822814942,
    0.04940614700317383,
    0.04661030769348144,
    0.04692840576171875,
    0.04164443016052246,
    0.030263948440551757,
    0.01933333873748779,
    0.012681674957275391,
    0.007493805885314941,
    0.004999542236328125,
    0.004284000396728516,
]

cpu_nocomp = [
    0.07327058315277099,
    0.04680111408233643,
    0.0450089693069458,
    0.04810197353363037,
    0.045330238342285153,
    0.03903043270111084,
    0.030336642265319826,
    0.020130085945129394,
    0.013105511665344238,
    0.0074312686920166016,
    0.005002784729003906,
    0.003685259819030762,
]


dense_cpu_comp = [
    0.013124966621398925,
    0.012895846366882324,
    0.013098478317260742,
    0.009731078147888183,
    0.008868217468261719,
    0.009262490272521972,
    0.008942055702209472,
    0.008935832977294922,
    0.008915472030639648,
    0.008994674682617188,
    0.008913040161132812,
    0.008860564231872559,
]



dense_gpu_comp = [
    0.00035347938537597654,
    0.00030732154846191406,
    0.0003076791763305664,
    0.0003082513809204102,
    0.0003075361251831055,
    0.0003080844879150391,
    0.00030891895294189454,
    0.00031611919403076174,
    0.0003170490264892578,
    0.00031583309173583985,
    0.0003154277801513672,
    0.00031597614288330077,
]


dense_cpu_nocomp = [
    0.009356546401977538,
    0.00962982177734375,
    0.009764647483825684,
    0.010028338432312012,
    0.009920310974121094,
    0.01003282070159912,
    0.010157418251037598,
    0.009996819496154784,
    0.009874200820922852,
    0.00999765396118164,
    0.010051321983337403,
    0.010118794441223145,
]



dense_gpu_nocomp = [
    0.0003175020217895508,
    0.00028545856475830077,
    0.0002846240997314453,
    0.00028476715087890627,
    0.0002847433090209961,
    0.00029408931732177734,
    0.00029881000518798827,
    0.0002997159957885742,
    0.0002987384796142578,
    0.0002985477447509766,
    0.00029850006103515625,
    0.00029835700988769533,
]




cusparse = [9.88467, 3.08541, 2.77091, 2.44362, 2.11549, 1.77578, 
           1.43878, 1.10499, 0.754688, 0.401664, 0.222176, 0.075328]

plt.figure(figsize=(10, 6))
plt.plot(sparsity, cuda_comp, 'go--', linewidth=1, markersize=4, label="cuda_comp")
plt.plot(sparsity, cuda_nocomp, 'ro--', linewidth=1, markersize=4, label="cuda_nocomp")
plt.plot(sparsity, cpu_comp, 'gv--', linewidth=1, markersize=4, label="cpu_comp")
plt.plot(sparsity, cpu_nocomp, 'rv--', linewidth=1, markersize=4, label="cpu_nocomp")
# plt.plot(sparsity, cusparse, 'b*-', linewidth=1, markersize=4, label="cpu_nocomp")

plt.plot(sparsity, dense_cpu_nocomp, 'rv-', linewidth=1, markersize=4, label="dense_cpu_nocomp")
plt.plot(sparsity, dense_cpu_comp, 'gv-', linewidth=1, markersize=4, label="dense_cpu_comp")

plt.plot(sparsity, dense_gpu_nocomp, 'ro-', linewidth=1, markersize=4, label="dense_cuda_nocomp")
plt.plot(sparsity, dense_gpu_comp, 'go-', linewidth=1, markersize=4, label="dense_cuda_comp")




plt.title("MM (3072, 768) * (768, 1024)", fontsize=14)
plt.xlabel("Sparsity (Fraction of Zeros)", fontsize=12)
plt.ylabel("Execution Time (ms)", fontsize=12)
plt.grid(True, linestyle='--', alpha=0.7)
#plt.yscale('log')  # Log scale to better see small values
plt.legend()
plt.show()
